# PAT의 동작 방식

> 출발지 사용자 IP: 10.10.10.10
> 목적지 사용자 IP: 20.20.20.20
> 출발지 포트: 2000
> 목적지 포트: 80

## 패킷 전송

출발지(`10.10.10.10`)로부터 목적지(`20.20.20.20`)으로 패킷을 전송한다.

## IP 및 포트 변경

보통 PAT는 다수의 네트워크 사용자가 하나의 포트로 변환되어 전송해야 하는 상황일 때 사용한다.  
이때, 포트가 달라지면 결국 똑같은 출발지라고 할 수 없다. 고로 출발지와 포트를 둘 다 변경해주는 것이다. (`11.11.11.11:3000`)  

## 재작성된 포트 및 IP 주소로 다시 전송

## 사용자에게 응답

목적지에 도착했으면, 패킷을 수신한 웹 서버는 출발지를 자기 자신(`20.20.20.20`)으로, 도착지는 (출발지 공인 IP 주소)로 응답을 전송한다.

## NAT 장비에서 NAT 테이블 확인

확인 결과, 출발지의 IP와 포트를 확인하여 `10.10.10.10`, `2000`이라는 원래의 IP 주소와 포트 번호를 확인한다.

## 사용자에게 전달

결과적으로 원래의 IP 주소와 포트번호에 맞는 사용자에게 패킷이 전달된다.

