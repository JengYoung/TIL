# NAT의 동작 방식

> 출발지 사용자 IP: 10.10.10.10
> 목적지 사용자 IP: 20.20.20.20

## 공인 IP로 주소 변경

목적지로 패킷을 전송하면, NAT 역할을 수행하는 장비를 거치게 된다.  
NAT 장비는 NAT 정책에 따라 외부 네트워크와 통신을 가능하도록 공인 IP로 변경한다.  
이때 변경된 주소는 NAT 테이블에 저장하게 된다.  

## 출발지 주소를 변경

변경된 공인 IP 주소를 기반으로 목적지 웹 서버로 전송한다.

## 사용자에게 응답

목적지에 도착했으면, 패킷을 수신한 웹 서버는 출발지를 자기 자신(`20.20.20.20`)으로, 도착지는 (출발지 공인 IP 주소)로 응답을 전송한다.

## NAT 테이블에서 체크

NAT 테이블은 웹 서버로부터 응답 패킷을 수신하게 된다.  
이때, 공인 IP 주소에 매핑된 사설 IP 주소를 찾아낸다.

## 최종 패킷 수신

최종적으로 원래 패킷 출발지 IP인 (`10.10.10.10`)으로 변경하여 사용자가 최종적으로 패킷을 수신한다.

