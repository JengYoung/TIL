# 인캡슐레이션과 디캡슐레이션

상위 계층에서 하위 계층으로 데이터를 보낸다면, 피지컬 계층에서 전기 신호 형태로 네트워크를 통해 신호를 보낸다. 이후 받는 쪽에서는 하위 계층에서 상위 계층으로 데이터를 보낸다. 이때

+ 인캡슐레이션: 데이터를 보내는 과정
+ 디캡슐레이션: 데이터를 받는 과정

을 의미한다.

## 패킷 네트워크의 관점에서

현대 네트워크는 패킷 네트워크이며, 패킷 네트워크에서 인캡슐레이션과 디캡슐레이션은 다음과 같은 역할을 한다.

+ 데이터를 패킷 단위로 쪼개어 보냄으로써 회선 전체를 점유하지 않고, 동시에 여러 단말이 통신할 수 있도록 함.
+ 이 과정에서 목적지로 보내는 과정에서는 패킷의 형태로 데이터를 쪼개고, 받는 쪽에서는 ACK를 토대로 패킷을 데이터 형태로 결합하여 사용함.
+ 여기서 인캡슐레이션은 패킷 형태로 쪼개는 과정에서 4 -> 3 -> 2 -> 1계층을 거치며 네트워크 전송을 위한 헤더에 관한 정보들을 비트 단위로 씀.
+ 반대로 디캡슐레이션은 전기 신호를 데이터 형태로 만들고(1 -> 2), 헤더를 확인함. 이때 자신에게 온 패킷이 아니면 데이터를 버림.(2계층의 랜 카드) 맞다면 3계층으로 보내고, 2계층에서 필요했던 헤더들은 벗겨냄. 이후 3계층 역시 필요한 헤더를 확인하여 맞다면 4계층으로 올려보내고, 4계층 역시 같은 방법으로 데이터의 유효성을 판단, 애플리케이션에 올려보내줌.

즉, 데이터가 전송되는 흐름은 크게 2가지 정보 흐름으로 설명이 가능하다.

+ 인캡슐레이션, 디캡슐레이션을 통해 데이터의 전송 과정
+ 각 계층 헤더에서의 검증을 통해 송신자/수신자 계층 간 논리적 통신 과정

결과적으로 계층간의 이동에서 주입되는 헤더들은, 해당 주입한 계층에서만 참고할 수 있도록 전달된다.

## 헤더

꽤나 이러한 헤더들의 정보가 많아 이해하기는 어렵다.  
다만 공통적으로 다음과 같은 정보가 포함되어야 한다.

1. 현재 계층에서 정의하는 정보 (각 계층에서의 목적에 맞는 정보)
2. 상위 프로토콜 지시자 (상위 프로토콜의 종류들이 많아질 때, 적합한 프로토콜을 간편하게 찾기 위함)

