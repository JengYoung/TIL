# **자바스크립트 엔진은 싱글 쓰레드**

자바스크립트 엔진의 `Call Stack`은 하나만 동작한다.

배열과 객체를 관리하기 위한 `Heap`도 하나.

> ⭐ **실제로 싱글 쓰레드가 맞다!**

# 브라우저에서 실행되는 스크립트의 비동기가 가능한 이유

브라우저에는 **이벤트 루프**가 있기 때문

이벤트 루프는 자바스크립트 엔진에 포함된 게 아니라 `Web APIs` `Task Queue`를 통해 가능.

브라우저는 **멀티 쓰레드**로 동작하기에 가능.

1. 스크립트가 실행되면 전역 스코프 내에서 실행
2. 코드가 순차적으로 실행되어 먼저 첫 `setTimeout` 실행.
3. 콜스택이 쌓임과 동시에 브라우저에서 `Web API` 실행.
4. 콜 스택에 있던 `setTimeout`은 종료. `foo` 함수 실행.
5. `foo`함수 안쪽에 있는 `console.log()`실행
6. 찍고 나면 `console.log()`가 콜스택에서 빠져 나옴.
7. `foo`도 종료되어 콜 스택에서 빠져나옴,.
8. 마지막 `setTimeout 빠져나옴.`
9. 바로 빠져나옴.
10. 콜스택이 비어져 있는 상태.
11. 0.1초가 지나 `Web API`가 `setTimeout` 을 다 태스크 큐로 집어넣음.
12. 콜스택이 비어있을 때 `Task Queue`에서 콜스택으로 하나씩 쌓아나감.
13. `bar`호출
14. `console.log()`쌓고 처리. 이후 바로 콜스택에서 빠져나옴.
15. `bar`도 종료.
16. `setTimeout` 종료.
17. 다시 또 태스크 넣음.
18. `console.log()` 처리, 이후 콜스택에서 나옴
19. `setTimeout` 종료.
