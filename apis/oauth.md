# 🔍 Oauth란

> 인터넷 사용자들이 다른 웹사이트 상의 자신들의 정보에 대해 접근권한을 부여할 수 있는 공통적인 수단으로써 사용되는, 접근 위임을 위한 개방형 표준이다. [위키백과](https://ko.wikipedia.org/wiki/OAuth)

# 배경

## 전통적인 해결 방법

이전에는 인증방식에 대한 웹 표준이 존재하지 않았다.  
따라서 사용자(`Resource Owner`)들은 웹(`Client`)을 통해 `Resource Server`에 ID와 패스워드를 사용하여 접근했었다.  
그러면 리소스 서버는 아이디와 비밀번호를 통해 모든 정보를 응답할 수 있음.  
그러나 **보안**에 아주 심각한 단점이 존재했었다.  

아이디와 패스워드를 누군지도 모르는 사람들에게 준다는 것은 너무나 치명적인 위험이 존재했다.

## 대안, `Oauth`

### 핵심 주체 3가지

+ 우리가 만들고 있는 웹, 앱 (`Client`)
+ 사용자, 데이터 주인 (`Resource Owner`)
+ 사용자 데이터를 보관하고 있는 곳(`Resource Server`)


1. 클라이언트(외부 웹/앱 애플리케이션)는 행정적인 일을 해야 함. 리소스 서버에 '우리의 서비스는 당신의 서비스를 사용할 것이다'라는 등록을 함.  
2. 리소스 서버는 서비스를 식별할 수 있도록 `client ID`와 `client Secret`을 줌.  
3. 이때 `Secret`은 절대 노출이 되어서는 안 되며, 클라이언트는 이를 잘 저장해놓음.  
4. 리소스 오너에게 클라이언트가 부탁을 해야 함. "리소스 서버에게 내가 어떠한 정보를 사용하겠다라는 것을 허락 받아주세요"라고 부탁을 해야 함.  
5. 창이 열리고, 이에 대해 리소스 오너가 확인 후 승인하면 리소스 서버로 이동.  
6. 창이 전환되는데, 로그인의 여부에 따라서 바뀐다. 로그인 유저는 권한 승인 요청 컴포넌트가 렌더링되고, 아니면 로그인 하라는 UI를 전달한다.  
7. 동의를 하게 되면 리소스 서버가 클라이언트에게 서버에 특정 기능 권한을 부여한 코드 정보를 전달한다. (리소스 오너가 이 클라이언트에게 리소스 서버의 특정 목록을 제공하도록 승인했다라는 정보를 받았기 때문)  
8. 클라이언트는 이 코드 값과 아이디, 시크릿을 담아 리소스 서버에게 다시 전달한다. (RedirectURL을 통한 비교)  
9. 리소스 서버는 클라이언트에게 발급했던 코드값, 자기가 맞다는 것을 증명하는 ID, 시크릿 값을 비교해서 리소스 서버 입장에서 권한을 달라고 조르고 있는 클라이언트가 리소스 오너가 승인한 그 클라이언트인지를 검증  
10. 그 검증 결과 ID, 시크릿, 코드가 유효하다면 리소스 서버는 클라이언트에게 중요한 정보를 발급한다. (`Authorization Code`)
11. 이 Authorization Code를 클라이언트가 직접 리소스 서버에 전달한다. 그러면 `Access Token`을 발급 받는다.
11. 이를 소중하게 잘 보관함. 이 액세스 토큰을 토대로 서버에 접속해서 리소스 서버에 요청.  
12. 자기가 발급한 적이 있는 토큰 값이면 값을 돌려주면 클라이언트는 이를 가공해서 리소스 오너에게 가치를 제공함.  

## SDK

이러한 원리들을 다른 개발자가 독단적으로 구현하는 것은 사실상 거의 불가능하기 때문에 제공자 측에서는 보통 `SDK`를 제공한다.
다만, 이러한 원리들을 먼저 선행하여 이해하고 적용해야 OAuth 도입이 쉬워진다.

# 📚 참고자료
[위키백과](https://ko.wikipedia.org/wiki/OAuth)
[유튜브 - 생활코딩](https://www.youtube.com/watch?v=9vh4VGjaMco)